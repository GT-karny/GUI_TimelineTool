# タイムラインエディタ開発計画書

## 目的
- 速度や舵角などの**時系列プロファイルをGUIで編集**し、シミュレータ検証に活用できるツールを開発する。  
- **MVPのゴール**は「キー打ちでカーブを作り、CSV出力して再利用できること」。  

---

## スコープ
- **対象ユーザー**：シミュレータ開発者、検証エンジニア  
- **環境**：Windows優先（Python + PyQt/PySide + pyqtgraph）  
- **MVPで対象とするトラック種**：  
  - Float  
  - Bool  
  - Event  

---

## MVP 機能一覧

### タイムライン編集
- マウス操作でキー追加／ドラッグ移動／削除  
- 補間：Linear / Cubic / Step  
- 再生ヘッド、ループ再生、ズーム／パン  
- Undo/Redo（基本操作対応）

### トラック管理
- 複数トラックを同時表示  
- プリセット（速度、舵角、ブレーキ、ライト など基本セット）  
- トラックごとに色を設定（固定色）

### 出力と保存
- 固定周期サンプリング（既定90 Hz／可変）で**CSVエクスポート**  
- **プロジェクト保存/読込（JSON）**：トラック構成、キー列、補間情報

### 検証・ガード
- 値クランプ  
- 時刻の単調増加チェック  

### UI/UX
- 単一テーマ（ダーク or ライト）  
- トラック色は既定値のみ  

---

## 開発フェーズ（MVP到達まで）

### P0：タイムライン基盤
- 単一Floatトラックでキー編集・補間・再生  
- 受け入れ基準：同じキー入力で常に同じ波形が生成される  

### P1：マルチトラック & Bool/Event
- Bool（ステップ保持）とEvent（単発マーカー）の実装  
- 複数トラック同時編集  
- 受け入れ基準：3種混在でも再生・出力が破綻しない  

### P2：出力と保存
- CSVエクスポート（固定周期サンプリング）  
- JSON保存／読込で状態を完全復元  
- 受け入れ基準：保存→再起動→読込で同じCSVを再出力可能  

### P3：編集快適化
- Undo/Redo  
- スナップ（時間/値）  
- キー一覧テーブルでの編集  
- 受け入れ基準：連続100操作で破綻なし  

### P4：仕上げ & 配布
- 単一テーマ整備（ダーク or ライト）  
- 設定保持（サンプルレートなど）  
- Windows用スタンドアロン実行ファイル配布  
- 受け入れ基準：クリーン環境で「起動→編集→CSV→保存→再起動→読込」が成立  

---

## 将来拡張（MVP後）
- Enum/Discreteトラック（値↔色編集）  
- UDPによるライブ配信（JSON/Protobuf）
- Bezier補間（Ease等のカーブ拡張を含む）
- テンプレ生成（台形／ランプ／S字など）  
- 再生速度可変、統計メーター  
- トラック折りたたみ／並べ替え  
- 多言語対応、柔軟なショートカット  
